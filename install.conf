### PREREQUISITES ###
### STRINGMAPS ###
 add policy stringmap SM_CS_CONTROL -comment "This stringmap is used to control application flow through content switching virtual servers"
 add policy stringmap SM_VS_CONTROL -comment "This stringmap is used to control access to load balancing virtual servers"
 add policy stringmap SM_IP_CONTROL -comment "This stringmap is used to control access to load balancing virtual servers based on client IP address"

 add policy stringmap SM_PORT_PROTOCOLS -comment "This stringmap is used to create a universal redirect policy valid for http and https"
bind policy stringmap SM_PORT_PROTOCOLS 443 "proto=https;switch=http;"
bind policy stringmap SM_PORT_PROTOCOLS 80 "proto=http;switch=https;"

 add policy stringmap SM_REDIR -comment "This stringmap is used to create a universal redirect policy valid for http and https"
bind policy stringmap SM_REDIR VS_REDIR_302 "HTTP/1.1 302 Found\r\nLocation: "
bind policy stringmap SM_REDIR VS_REDIR_301 "HTTP/1.1 301 Moved Permanently\r\nLocation: "

### PATTERN SETS ###
 add policy patset PS_NAME_PROTOCOLS -comment "This pattern set is used to create a universal name convention per protocol for vservers"
bind policy patset PS_NAME_PROTOCOLS _HTTP -index 1
bind policy patset PS_NAME_PROTOCOLS _HTTPS -index 2
bind policy patset PS_NAME_PROTOCOLS _SSL -index 3
bind policy patset PS_NAME_PROTOCOLS _ssl -index 4
bind policy patset PS_NAME_PROTOCOLS _https -index 5
bind policy patset PS_NAME_PROTOCOLS _http -index 6
bind policy patset PS_NAME_PROTOCOLS _TCP -index 7
bind policy patset PS_NAME_PROTOCOLS _tcp -index 8
bind policy patset PS_NAME_PROTOCOLS _STCP -index 9
bind policy patset PS_NAME_PROTOCOLS _stcp -index 10
bind policy patset PS_NAME_PROTOCOLS _UDP -index 11
bind policy patset PS_NAME_PROTOCOLS _udp -index 12

### POLICY EXPRESSIONS ###
### VERSION INDEPENDENT ###
### NAMING CONVENTIONS ###
add policy expression PE_CS_PREFIX "\"CS_\""
add policy expression PE_VS_PREFIX "\"VS_\""
add policy expression PE_VS_SUFFIX_TCP "\"_T\""
add policy expression PE_VS_SUFFIX_UDP "\"_U\""


### VERSION SPECIFIC ###
### DEBUG CONTROLS ###
add policy expression PE_CL10_6_DEBUG true

### TRANSACTION IDENTIFIERS ###
add policy expression PE_CL10_6_REQ_TXID HTTP.REQ.TXID.BEFORE_STR("-")
add policy expression PE_CL10_6_RES_TXID HTTP.RES.TXID.BEFORE_STR("-")

### REDIRECT PROTOCOLS ###
add policy expression PE_CL10_6_HTTP_SWITCH "CLIENT.TCP.DSTPORT.TYPECAST_TEXT_T.MAP_STRING(\"SM_PORT_PROTOCOLS\").AFTER_STR(\"switch=\").BEFORE_STR(\";\") ALT \"https\""
add policy expression PE_CL10_6_HTTP_REDIR "HTTP.REQ.LB_VSERVER.NAME.MAP_STRING(\"SM_REDIR\") ALT \"HTTP/1.1 302 Found\r\nLocation: \""
add policy expression PE_CL10_6_IS_SSL "HTTP.REQ.CS_VSERVER.NAME.ENDSWITH(\"_HTTP\").NOT" -comment "client.ssl.is_ssl does not seem to work correctly"


### RESPONDER ACTIONS ###
add responder action RSA_CL10_6_NO_SERVICE respondwithhtmlpage resppage_no_service -responseStatusCode 200

add audit messageaction LOG_CL10_6_RSP_CL10_6_BLOCKED INFORMATIONAL "\"RSP_CL10_6_BLOCKED - \" + HTTP.REQ.CS_VSERVER.NAME + \" - \" + HTTP.REQ.LB_VSERVER.NAME + \" - \" + HTTP.REQ.HOSTNAME.SERVER + \" - \" + HTTP.REQ.URL" -bypassSafetyCheck YES
add responder action RSA_CL10_6_BLOCKED respondwithhtmlpage resppage_blocked -responseStatusCode 200
add responder policy RSP_CL10_6_BLOCKED true RSA_CL10_6_BLOCKED

add audit messageaction LOG_CL10_6_RSP_CL10_6_DROP INFORMATIONAL "\"RSP_CL10_6_DROP - \" + HTTP.REQ.CS_VSERVER.NAME + \" - \" + HTTP.REQ.LB_VSERVER.NAME + \" - \" + HTTP.REQ.HOSTNAME.SERVER + \" - \" + HTTP.REQ.URL" -bypassSafetyCheck YES
add responder policy RSP_CL10_6_DROP true DROP

add audit messageaction LOG_CL10_6_RSP_CL10_6_RESET INFORMATIONAL "\"RSP_CL10_6_RESET - \" + HTTP.REQ.CS_VSERVER.NAME + \" - \" + HTTP.REQ.LB_VSERVER.NAME + \" - \" + HTTP.REQ.HOSTNAME.SERVER + \" - \" + HTTP.REQ.URL" -bypassSafetyCheck YES
add responder policy RSP_CL10_6_RESET true RESET

add audit messageaction LOG_CL10_6_REDIR_302_SWITCH INFORMATIONAL "\"REDIR_302_SWITCH - \" + HTTP.REQ.CS_VSERVER.NAME + \" - \" + HTTP.REQ.LB_VSERVER.NAME + \" - \" + HTTP.REQ.HOSTNAME.SERVER + \" - \" + HTTP.REQ.URL" -bypassSafetyCheck YES
add responder action RSA_CL10_6_REDIR_302_SWITCH respondwith q{"HTTP/1.1 302 Moved\r\nLocation: " + PE_CL10_6_HTTP_SWITCH + "://" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH_AND_QUERY + "\r\n\r\n"}
add responder policy RSP_CL10_6_REDIR_302_SWITCH true RSA_CL10_6_REDIR_302_SWITCH




### CONTENT SWITCHING ###
### DETECT LAN###
add policy expression PE_CL10_6_TCP_CS_IP_ISLAN_1X "(CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(19).TYPECAST_TEXT_T + \"/19\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(18).TYPECAST_TEXT_T + \"/18\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(17).TYPECAST_TEXT_T + \"/17\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(16).TYPECAST_TEXT_T + \"/16\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(15).TYPECAST_TEXT_T + \"/15\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(14).TYPECAST_TEXT_T + \"/14\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"
add policy expression PE_CL10_6_TCP_CS_IP_ISLAN_2X_A "(CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(24).TYPECAST_TEXT_T + \"/24\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(23).TYPECAST_TEXT_T + \"/23\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(22).TYPECAST_TEXT_T + \"/22\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(21).TYPECAST_TEXT_T + \"/21\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(20).TYPECAST_TEXT_T + \"/20\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"
add policy expression PE_CL10_6_TCP_CS_IP_ISLAN_2X_B "(CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(29).TYPECAST_TEXT_T + \"/29\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(28).TYPECAST_TEXT_T + \"/28\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(27).TYPECAST_TEXT_T + \"/27\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(26).TYPECAST_TEXT_T + \"/26\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(25).TYPECAST_TEXT_T + \"/25\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"
add policy expression PE_CL10_6_TCP_CS_IP_ISLAN_3X "(CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.TYPECAST_TEXT_T + \"/32\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(31).TYPECAST_TEXT_T + \"/31\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(30).TYPECAST_TEXT_T + \"/30\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"

add policy expression PE_CL10_6_UDP_CS_IP_ISLAN_1X "(CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(19).TYPECAST_TEXT_T + \"/19\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(18).TYPECAST_TEXT_T + \"/18\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(17).TYPECAST_TEXT_T + \"/17\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(16).TYPECAST_TEXT_T + \"/16\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(15).TYPECAST_TEXT_T + \"/15\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(14).TYPECAST_TEXT_T + \"/14\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"
add policy expression PE_CL10_6_UDP_CS_IP_ISLAN_2X_A "(CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(24).TYPECAST_TEXT_T + \"/24\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(23).TYPECAST_TEXT_T + \"/23\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(22).TYPECAST_TEXT_T + \"/22\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(21).TYPECAST_TEXT_T + \"/21\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(20).TYPECAST_TEXT_T + \"/20\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"
add policy expression PE_CL10_6_UDP_CS_IP_ISLAN_2X_B "(CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(29).TYPECAST_TEXT_T + \"/29\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(28).TYPECAST_TEXT_T + \"/28\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(27).TYPECAST_TEXT_T + \"/27\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(26).TYPECAST_TEXT_T + \"/26\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(25).TYPECAST_TEXT_T + \"/25\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"
add policy expression PE_CL10_6_UDP_CS_IP_ISLAN_3X "(CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.TYPECAST_TEXT_T + \"/32\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(31).TYPECAST_TEXT_T + \"/31\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.UDP.CS_VSERVER.NAME.BEFORE_STR_ANY(\"PS_NAME_PROTOCOLS\").TO_LOWER + \";lan;\" + CLIENT.IP.SRC.SUBNET(30).TYPECAST_TEXT_T + \"/30\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"

### FULL - LAN ###
add policy expression PE_CL10_6_HTTP_CS_FULL_LAN_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER"
add policy expression PE_CL10_6_HTTP_CS_FULL_LAN_KEY_EXISTS "((HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CS_CONTROL\"))"
add policy expression PE_CL10_6_HTTP_CS_FULL_LAN_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL10_6_HTTP_CS_FULL_LAN_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add audit messageaction LOG_CL10_6_HTTP_CSP_FULL_LAN INFORMATIONAL q/"CL_10_6_CSP,HTTP,FULL,LAN," + PE_CL10_6_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL10_6_HTTP_CS_FULL_LAN_KEY + "," + PE_CL10_6_HTTP_CS_FULL_LAN_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_NO_SERVICE_FULL_LAN INFORMATIONAL q/"CL_10_6_RSP,HTTP,FULL,LAN,NOSVC," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FULL_LAN_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_FULL_LAN INFORMATIONAL q/"CL_10_6_RSP,HTTP,FULL,LAN,REDIR," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FULL_LAN_VALUE_DST/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_FULL_LAN INFORMATIONAL q/"CL_10_6_RSP,HTTP,FULL,LAN,REDIR_KEEPPATH," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FULL_LAN_VALUE_DST/ -bypassSafetyCheck YES

add cs action CSA_CL10_6_FULL_LAN -targetVserverExpr PE_CL10_6_HTTP_CS_FULL_LAN_VALUE_VS
add cs policy CSP_CL10_6_FULL_LAN -rule "(PE_CL10_6_HTTP_CS_FULL_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" -action CSA_CL10_6_FULL_LAN -logAction LOG_CL10_6_HTTP_CSP_FULL_LAN

add responder action RSA_CL10_6_REDIR_FULL_LAN respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_FULL_LAN_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_FULL_LAN "(PE_CL10_6_HTTP_CS_FULL_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" RSA_CL10_6_REDIR_FULL_LAN -logAction LOG_CL10_6_HTTP_RSP_REDIR_FULL_LAN
add responder action RSA_CL10_6_REDIR_KEEPPATH_FULL_LAN respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_FULL_LAN_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_KEEPPATH_FULL_LAN "(PE_CL10_6_HTTP_CS_FULL_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" RSA_CL10_6_REDIR_KEEPPATH_FULL_LAN -logAction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_FULL_LAN
add responder policy RSP_CL10_6_NO_SERVICE_FULL_LAN "(PE_CL10_6_HTTP_CS_FULL_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" RSA_CL10_6_NO_SERVICE -logAction LOG_CL10_6_HTTP_RSP_NO_SERVICE_FULL_LAN

### FULL - DEF ###
add policy expression PE_CL10_6_HTTP_CS_FULL_ANY_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER"
add policy expression PE_CL10_6_HTTP_CS_FULL_ANY_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CS_CONTROL\")"
add policy expression PE_CL10_6_HTTP_CS_FULL_ANY_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL10_6_HTTP_CS_FULL_ANY_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add audit messageaction LOG_CL10_6_HTTP_CSP_FULL_ANY INFORMATIONAL q/"CL_10_6_CSP,HTTP,FULL,ANY," + PE_CL10_6_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL10_6_HTTP_CS_FULL_ANY_KEY + "," + PE_CL10_6_HTTP_CS_FULL_ANY_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_NO_SERVICE_FULL_ANY INFORMATIONAL q/"CL_10_6_RSP,HTTP,FULL,ANY,NOSVC," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FULL_ANY_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_FULL_ANY INFORMATIONAL q/"CL_10_6_RSP,HTTP,FULL,ANY,REDIR," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FULL_ANY_VALUE_DST/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_FULL_ANY INFORMATIONAL q/"CL_10_6_RSP,HTTP,FULL,ANY,REDIR_KEEPPATH," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FULL_ANY_VALUE_DST/ -bypassSafetyCheck YES

add cs action CSA_CL10_6_FULL_ANY -targetVserverExpr PE_CL10_6_HTTP_CS_FULL_ANY_VALUE_VS
add cs policy CSP_CL10_6_FULL_ANY -rule PE_CL10_6_HTTP_CS_FULL_ANY_KEY_EXISTS -action CSA_CL10_6_FULL_ANY -logAction LOG_CL10_6_HTTP_CSP_FULL_ANY

add responder action RSA_CL10_6_REDIR_FULL_ANY respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_FULL_ANY_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_FULL_ANY PE_CL10_6_HTTP_CS_FULL_ANY_KEY_EXISTS RSA_CL10_6_REDIR_FULL_ANY -logAction LOG_CL10_6_HTTP_RSP_REDIR_FULL_ANY
add responder action RSA_CL10_6_REDIR_KEEPPATH_FULL_ANY respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_FULL_ANY_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_KEEPPATH_FULL_ANY PE_CL10_6_HTTP_CS_FULL_ANY_KEY_EXISTS RSA_CL10_6_REDIR_KEEPPATH_FULL_ANY -logAction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_FULL_ANY
add responder policy RSP_CL10_6_NO_SERVICE_FULL_ANY PE_CL10_6_HTTP_CS_FULL_ANY_KEY_EXISTS RSA_CL10_6_NO_SERVICE -logAction LOG_CL10_6_HTTP_RSP_NO_SERVICE_FULL_ANY

### SCND - LAN ###
add policy expression PE_CL10_6_HTTP_CS_SCND_LAN_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER"
add policy expression PE_CL10_6_HTTP_CS_SCND_LAN_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CS_CONTROL\")"
add policy expression PE_CL10_6_HTTP_CS_SCND_LAN_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL10_6_HTTP_CS_SCND_LAN_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add audit messageaction LOG_CL10_6_HTTP_CSP_SCND_LAN INFORMATIONAL q/"CL_10_6_CSP,HTTP,SCND,LAN," + PE_CL10_6_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL10_6_HTTP_CS_SCND_LAN_KEY + "," + PE_CL10_6_HTTP_CS_SCND_LAN_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_NO_SERVICE_SCND_LAN INFORMATIONAL q/"CL_10_6_RSP,HTTP,SCND,LAN,NOSVC," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_SCND_LAN_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_SCND_LAN INFORMATIONAL q/"CL_10_6_RSP,HTTP,SCND,LAN,REDIR," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_SCND_LAN_VALUE_DST/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_SCND_LAN INFORMATIONAL q/"CL_10_6_RSP,HTTP,SCND,LAN,REDIR_KEEPPATH," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_SCND_LAN_VALUE_DST/ -bypassSafetyCheck YES

add cs action CSA_CL10_6_SCND_LAN -targetVserverExpr PE_CL10_6_HTTP_CS_SCND_LAN_VALUE_VS
add cs policy CSP_CL10_6_SCND_LAN -rule "(PE_CL10_6_HTTP_CS_SCND_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" -action CSA_CL10_6_SCND_LAN -logAction LOG_CL10_6_HTTP_CSP_SCND_LAN

add responder action RSA_CL10_6_REDIR_SCND_LAN respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_SCND_LAN_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_SCND_LAN "(PE_CL10_6_HTTP_CS_SCND_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" RSA_CL10_6_REDIR_SCND_LAN -logAction LOG_CL10_6_HTTP_RSP_REDIR_SCND_LAN
add responder action RSA_CL10_6_REDIR_KEEPPATH_SCND_LAN respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_SCND_LAN_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_KEEPPATH_SCND_LAN "(PE_CL10_6_HTTP_CS_SCND_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" RSA_CL10_6_REDIR_KEEPPATH_SCND_LAN -logAction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_SCND_LAN
add responder policy RSP_CL10_6_NO_SERVICE_SCND_LAN "(PE_CL10_6_HTTP_CS_SCND_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" RSA_CL10_6_NO_SERVICE -logAction LOG_CL10_6_HTTP_RSP_NO_SERVICE_SCND_LAN

### SCND - DEF ###
add policy expression PE_CL10_6_HTTP_CS_SCND_ANY_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER"
add policy expression PE_CL10_6_HTTP_CS_SCND_ANY_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CS_CONTROL\")"
add policy expression PE_CL10_6_HTTP_CS_SCND_ANY_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL10_6_HTTP_CS_SCND_ANY_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1) + \"/\" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add audit messageaction LOG_CL10_6_HTTP_CSP_SCND_ANY INFORMATIONAL q/"CL_10_6_CSP,HTTP,SCND,ANY," + PE_CL10_6_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL10_6_HTTP_CS_SCND_ANY_KEY + "," + PE_CL10_6_HTTP_CS_SCND_ANY_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_NO_SERVICE_SCND_ANY INFORMATIONAL q/"CL_10_6_RSP,HTTP,SCND,ANY,NOSVC," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_SCND_ANY_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_SCND_ANY INFORMATIONAL q/"CL_10_6_RSP,HTTP,SCND,ANY,REDIR," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_SCND_ANY_VALUE_DST/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_SCND_ANY INFORMATIONAL q/"CL_10_6_RSP,HTTP,SCND,ANY,REDIR_KEEPPATH," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_SCND_ANY_VALUE_DST/ -bypassSafetyCheck YES

add cs action CSA_CL10_6_SCND_ANY -targetVserverExpr PE_CL10_6_HTTP_CS_SCND_ANY_VALUE_VS
add cs policy CSP_CL10_6_SCND_ANY -rule PE_CL10_6_HTTP_CS_SCND_ANY_KEY_EXISTS -action CSA_CL10_6_SCND_ANY -logAction LOG_CL10_6_HTTP_CSP_SCND_ANY

add responder action RSA_CL10_6_REDIR_SCND_ANY respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_SCND_ANY_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_SCND_ANY PE_CL10_6_HTTP_CS_SCND_ANY_KEY_EXISTS RSA_CL10_6_REDIR_SCND_ANY -logAction LOG_CL10_6_HTTP_RSP_REDIR_SCND_ANY
add responder action RSA_CL10_6_REDIR_KEEPPATH_SCND_ANY respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_SCND_ANY_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_KEEPPATH_SCND_ANY PE_CL10_6_HTTP_CS_SCND_ANY_KEY_EXISTS RSA_CL10_6_REDIR_KEEPPATH_SCND_ANY -logAction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_SCND_ANY
add responder policy RSP_CL10_6_NO_SERVICE_SCND_ANY PE_CL10_6_HTTP_CS_SCND_ANY_KEY_EXISTS RSA_CL10_6_NO_SERVICE -logAction LOG_CL10_6_HTTP_RSP_NO_SERVICE_SCND_ANY

### FRST - LAN ###
add policy expression PE_CL10_6_HTTP_CS_FRST_LAN_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER"
add policy expression PE_CL10_6_HTTP_CS_FRST_LAN_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CS_CONTROL\")"
add policy expression PE_CL10_6_HTTP_CS_FRST_LAN_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL10_6_HTTP_CS_FRST_LAN_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add audit messageaction LOG_CL10_6_HTTP_CSP_FRST_LAN INFORMATIONAL q/"CL_10_6_CSP,HTTP,FRST,LAN," + PE_CL10_6_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL10_6_HTTP_CS_FRST_LAN_KEY + "," + PE_CL10_6_HTTP_CS_FRST_LAN_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_NO_SERVICE_FRST_LAN INFORMATIONAL q/"CL_10_6_RSP,HTTP,FRST,LAN,NOSVC," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FRST_LAN_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_FRST_LAN INFORMATIONAL q/"CL_10_6_RSP,HTTP,FRST,LAN,REDIR," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FRST_LAN_VALUE_DST/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_FRST_LAN INFORMATIONAL q/"CL_10_6_RSP,HTTP,FRST,LAN,REDIR_KEEPPATH," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FRST_LAN_VALUE_DST/ -bypassSafetyCheck YES

add cs action CSA_CL10_6_FRST_LAN -targetVserverExpr PE_CL10_6_HTTP_CS_FRST_LAN_VALUE_VS
add cs policy CSP_CL10_6_FRST_LAN -rule "(PE_CL10_6_HTTP_CS_FRST_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" -action CSA_CL10_6_FRST_LAN -logAction LOG_CL10_6_HTTP_CSP_FRST_LAN

add responder action RSA_CL10_6_REDIR_FRST_LAN respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_FRST_LAN_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_FRST_LAN "(PE_CL10_6_HTTP_CS_FRST_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" RSA_CL10_6_REDIR_FRST_LAN -logAction LOG_CL10_6_HTTP_RSP_REDIR_FRST_LAN
add responder action RSA_CL10_6_REDIR_KEEPPATH_FRST_LAN respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_FRST_LAN_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_KEEPPATH_FRST_LAN "(PE_CL10_6_HTTP_CS_FRST_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" RSA_CL10_6_REDIR_KEEPPATH_FRST_LAN -logAction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_FRST_LAN
add responder policy RSP_CL10_6_NO_SERVICE_FRST_LAN "(PE_CL10_6_HTTP_CS_FRST_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" RSA_CL10_6_NO_SERVICE -logAction LOG_CL10_6_HTTP_RSP_NO_SERVICE_FRST_LAN

### FRST - DEF ###
add policy expression PE_CL10_6_HTTP_CS_FRST_ANY_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER"
add policy expression PE_CL10_6_HTTP_CS_FRST_ANY_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CS_CONTROL\")"
add policy expression PE_CL10_6_HTTP_CS_FRST_ANY_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL10_6_HTTP_CS_FRST_ANY_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER + \"/\" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add audit messageaction LOG_CL10_6_HTTP_CSP_FRST_ANY INFORMATIONAL q/"CL_10_6_CSP,HTTP,FRST,ANY," + PE_CL10_6_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL10_6_HTTP_CS_FRST_ANY_KEY + "," + PE_CL10_6_HTTP_CS_FRST_ANY_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_NO_SERVICE_FRST_ANY INFORMATIONAL q/"CL_10_6_RSP,HTTP,FRST,ANY,NOSVC," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FRST_ANY_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_FRST_ANY INFORMATIONAL q/"CL_10_6_RSP,HTTP,FRST,ANY,REDIR," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FRST_ANY_VALUE_DST/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_FRST_ANY INFORMATIONAL q/"CL_10_6_RSP,HTTP,FRST,ANY,REDIR_KEEPPATH," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FRST_ANY_VALUE_DST/ -bypassSafetyCheck YES

add cs action CSA_CL10_6_FRST_ANY -targetVserverExpr PE_CL10_6_HTTP_CS_FRST_ANY_VALUE_VS
add cs policy CSP_CL10_6_FRST_ANY -rule PE_CL10_6_HTTP_CS_FRST_ANY_KEY_EXISTS -action CSA_CL10_6_FRST_ANY -logAction LOG_CL10_6_HTTP_CSP_FRST_ANY

add responder action RSA_CL10_6_REDIR_FRST_ANY respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_FRST_ANY_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_FRST_ANY PE_CL10_6_HTTP_CS_FRST_ANY_KEY_EXISTS RSA_CL10_6_REDIR_FRST_ANY -logAction LOG_CL10_6_HTTP_RSP_REDIR_FRST_ANY
add responder action RSA_CL10_6_REDIR_KEEPPATH_FRST_ANY respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_FRST_ANY_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_KEEPPATH_FRST_ANY PE_CL10_6_HTTP_CS_FRST_ANY_KEY_EXISTS RSA_CL10_6_REDIR_KEEPPATH_FRST_ANY -logAction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_FRST_ANY
add responder policy RSP_CL10_6_NO_SERVICE_FRST_ANY PE_CL10_6_HTTP_CS_FRST_ANY_KEY_EXISTS RSA_CL10_6_NO_SERVICE -logAction LOG_CL10_6_HTTP_RSP_NO_SERVICE_FRST_ANY

# FQDN - LAN ###
add policy expression PE_CL10_6_HTTP_CS_FQDN_LAN_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER"
add policy expression PE_CL10_6_HTTP_CS_FQDN_LAN_KEY_EXISTS "((HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CS_CONTROL\"))"
add policy expression PE_CL10_6_HTTP_CS_FQDN_LAN_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL10_6_HTTP_CS_FQDN_LAN_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";lan;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add audit messageaction LOG_CL10_6_HTTP_CSP_FQDN_LAN INFORMATIONAL q/"CL_10_6_CSP,HTTP,FQDN,LAN," + PE_CL10_6_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL10_6_HTTP_CS_FQDN_LAN_KEY + "," + PE_CL10_6_HTTP_CS_FQDN_LAN_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_NO_SERVICE_FQDN_LAN INFORMATIONAL q/"CL_10_6_RSP,HTTP,FQDN,LAN,NOSVC," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FQDN_LAN_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_FQDN_LAN INFORMATIONAL q/"CL_10_6_RSP,HTTP,FQDN,LAN,REDIR," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FQDN_LAN_VALUE_DST/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_FQDN_LAN INFORMATIONAL q/"CL_10_6_RSP,HTTP,FQDN,LAN,REDIR_KEEPPATH," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FQDN_LAN_VALUE_DST/ -bypassSafetyCheck YES

add cs action CSA_CL10_6_FQDN_LAN -targetVserverExpr PE_CL10_6_HTTP_CS_FQDN_LAN_VALUE_VS
add cs policy CSP_CL10_6_FQDN_LAN -rule "(PE_CL10_6_HTTP_CS_FQDN_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" -action CSA_CL10_6_FQDN_LAN -logAction LOG_CL10_6_HTTP_CSP_FQDN_LAN

add responder action RSA_CL10_6_REDIR_FQDN_LAN respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_FQDN_LAN_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_FQDN_LAN "(PE_CL10_6_HTTP_CS_FQDN_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" RSA_CL10_6_REDIR_FQDN_LAN -logAction LOG_CL10_6_HTTP_RSP_REDIR_FQDN_LAN
add responder action RSA_CL10_6_REDIR_KEEPPATH_FQDN_LAN respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_FQDN_LAN_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_KEEPPATH_FQDN_LAN "(PE_CL10_6_HTTP_CS_FQDN_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" RSA_CL10_6_REDIR_KEEPPATH_FQDN_LAN -logAction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_FQDN_LAN
add responder policy RSP_CL10_6_NO_SERVICE_FQDN_LAN "(PE_CL10_6_HTTP_CS_FQDN_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" RSA_CL10_6_NO_SERVICE -logAction LOG_CL10_6_HTTP_RSP_NO_SERVICE_FQDN_LAN

# FQDN - DEF ###
add policy expression PE_CL10_6_HTTP_CS_FQDN_ANY_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER"
add policy expression PE_CL10_6_HTTP_CS_FQDN_ANY_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CS_CONTROL\")"
add policy expression PE_CL10_6_HTTP_CS_FQDN_ANY_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL10_6_HTTP_CS_FQDN_ANY_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";any;\" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add audit messageaction LOG_CL10_6_HTTP_CSP_FQDN_ANY INFORMATIONAL q/"CL_10_6_CSP,HTTP,FQDN,ANY," + PE_CL10_6_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL10_6_HTTP_CS_FQDN_ANY_KEY + "," + PE_CL10_6_HTTP_CS_FQDN_ANY_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_NO_SERVICE_FQDN_ANY INFORMATIONAL q/"CL_10_6_RSP,HTTP,FQDN,ANY,NOSVC," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FQDN_ANY_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_FQDN_ANY INFORMATIONAL q/"CL_10_6_RSP,HTTP,FQDN,ANY,REDIR," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FQDN_ANY_VALUE_DST/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_FQDN_ANY INFORMATIONAL q/"CL_10_6_RSP,HTTP,FQDN,ANY,REDIR_KEEPPATH," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_FQDN_ANY_VALUE_DST/ -bypassSafetyCheck YES

add cs action CSA_CL10_6_FQDN_ANY -targetVserverExpr PE_CL10_6_HTTP_CS_FQDN_ANY_VALUE_VS
add cs policy CSP_CL10_6_FQDN_ANY -rule PE_CL10_6_HTTP_CS_FQDN_ANY_KEY_EXISTS -action CSA_CL10_6_FQDN_ANY -logAction LOG_CL10_6_HTTP_CSP_FQDN_ANY

add responder action RSA_CL10_6_REDIR_FQDN_ANY respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_FQDN_ANY_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_FQDN_ANY PE_CL10_6_HTTP_CS_FQDN_ANY_KEY_EXISTS RSA_CL10_6_REDIR_FQDN_ANY -logAction LOG_CL10_6_HTTP_RSP_REDIR_FQDN_ANY
add responder action RSA_CL10_6_REDIR_KEEPPATH_FQDN_ANY respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_FQDN_ANY_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_KEEPPATH_FQDN_ANY PE_CL10_6_HTTP_CS_FQDN_ANY_KEY_EXISTS RSA_CL10_6_REDIR_KEEPPATH_FQDN_ANY -logAction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_FQDN_ANY
add responder policy RSP_CL10_6_NO_SERVICE_FQDN_ANY PE_CL10_6_HTTP_CS_FQDN_ANY_KEY_EXISTS RSA_CL10_6_NO_SERVICE -logAction LOG_CL10_6_HTTP_RSP_NO_SERVICE_FQDN_ANY

### WILD - LAN ###
add policy expression PE_CL10_6_HTTP_CS_WILD_LAN_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";lan;*.\" + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER"
add policy expression PE_CL10_6_HTTP_CS_WILD_LAN_KEY_EXISTS "((HTTP.REQ.CS_VSERVER.NAME + \";lan;*.\" + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CS_CONTROL\"))"
add policy expression PE_CL10_6_HTTP_CS_WILD_LAN_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";lan;*.\" +  HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL10_6_HTTP_CS_WILD_LAN_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";lan;*.\" + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add audit messageaction LOG_CL10_6_HTTP_CSP_WILD_LAN INFORMATIONAL q/"CL_10_6_CSP,HTTP,WILD,LAN," + PE_CL10_6_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL10_6_HTTP_CS_WILD_LAN_KEY + "," + PE_CL10_6_HTTP_CS_WILD_LAN_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_NO_SERVICE_WILD_LAN INFORMATIONAL q/"CL_10_6_RSP,HTTP,WILD,LAN,NOSVC," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_WILD_LAN_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_WILD_LAN INFORMATIONAL q/"CL_10_6_RSP,HTTP,WILD,LAN,REDIR," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_WILD_LAN_VALUE_DST/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_WILD_LAN INFORMATIONAL q/"CL_10_6_RSP,HTTP,WILD,LAN,REDIR_KEEPPATH," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_WILD_LAN_VALUE_DST/ -bypassSafetyCheck YES

add cs action CSA_CL10_6_WILD_LAN -targetVserverExpr PE_CL10_6_HTTP_CS_WILD_LAN_VALUE_VS
add cs policy CSP_CL10_6_WILD_LAN -rule "(PE_CL10_6_HTTP_CS_WILD_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" -action CSA_CL10_6_WILD_LAN -logAction LOG_CL10_6_HTTP_CSP_WILD_LAN

add responder action RSA_CL10_6_REDIR_WILD_LAN respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_WILD_LAN_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_WILD_LAN "(PE_CL10_6_HTTP_CS_WILD_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" RSA_CL10_6_REDIR_WILD_LAN -logAction LOG_CL10_6_HTTP_RSP_REDIR_WILD_LAN
add responder action RSA_CL10_6_REDIR_KEEPPATH_WILD_LAN respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_WILD_LAN_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_KEEPPATH_WILD_LAN "(PE_CL10_6_HTTP_CS_WILD_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" RSA_CL10_6_REDIR_KEEPPATH_WILD_LAN -logAction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_WILD_LAN
add responder policy RSP_CL10_6_NO_SERVICE_WILD_LAN "(PE_CL10_6_HTTP_CS_WILD_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" RSA_CL10_6_NO_SERVICE -logAction LOG_CL10_6_HTTP_RSP_NO_SERVICE_WILD_LAN

### WILD - DEF ###
add policy expression PE_CL10_6_HTTP_CS_WILD_ANY_KEY "(HTTP.REQ.CS_VSERVER.NAME + \";any;*.\" + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER"
add policy expression PE_CL10_6_HTTP_CS_WILD_ANY_KEY_EXISTS "(HTTP.REQ.CS_VSERVER.NAME + \";any;*.\" + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CS_CONTROL\")"
add policy expression PE_CL10_6_HTTP_CS_WILD_ANY_VALUE_DST "(HTTP.REQ.CS_VSERVER.NAME + \";any;*.\" + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"dst=\").BEFORE_STR(\";\")"
add policy expression PE_CL10_6_HTTP_CS_WILD_ANY_VALUE_VS "(HTTP.REQ.CS_VSERVER.NAME + \";any;*.\" + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add audit messageaction LOG_CL10_6_HTTP_CSP_WILD_ANY INFORMATIONAL q/"CL_10_6_CSP,HTTP,WILD,ANY," + PE_CL10_6_REQ_TXID + "," + CLIENT.IP.SRC + "," + HTTP.REQ.CS_VSERVER.NAME + "," + HTTP.REQ.HOSTNAME + "," + HTTP.REQ.URL.PATH + "," + PE_CL10_6_HTTP_CS_WILD_ANY_KEY + "," + PE_CL10_6_HTTP_CS_WILD_ANY_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_NO_SERVICE_WILD_ANY INFORMATIONAL q/"CL_10_6_RSP,HTTP,WILD,ANY,NOSVC," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_WILD_ANY_VALUE_VS/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_WILD_ANY INFORMATIONAL q/"CL_10_6_RSP,HTTP,WILD,ANY,REDIR," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_WILD_ANY_VALUE_DST/ -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_WILD_ANY INFORMATIONAL q/"CL_10_6_RSP,HTTP,WILD,ANY,REDIR_KEEPPATH," + PE_CL10_6_REQ_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + PE_CL10_6_HTTP_CS_WILD_ANY_VALUE_DST/ -bypassSafetyCheck YES

add cs action CSA_CL10_6_WILD_ANY -targetVserverExpr PE_CL10_6_HTTP_CS_WILD_ANY_VALUE_VS
add cs policy CSP_CL10_6_WILD_ANY -rule PE_CL10_6_HTTP_CS_WILD_ANY_KEY_EXISTS -action CSA_CL10_6_WILD_ANY -logAction LOG_CL10_6_HTTP_CSP_WILD_ANY

add responder action RSA_CL10_6_REDIR_WILD_ANY respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_WILD_ANY_VALUE_DST + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_WILD_ANY PE_CL10_6_HTTP_CS_WILD_ANY_KEY_EXISTS RSA_CL10_6_REDIR_WILD_ANY -logAction LOG_CL10_6_HTTP_RSP_REDIR_WILD_ANY
add responder action RSA_CL10_6_REDIR_KEEPPATH_WILD_ANY respondwith q/PE_CL10_6_HTTP_REDIR + PE_CL10_6_HTTP_CS_WILD_ANY_VALUE_DST + HTTP.REQ.URL.PATH + "\r\n\r\n"/
add responder policy RSP_CL10_6_REDIR_KEEPPATH_WILD_ANY PE_CL10_6_HTTP_CS_WILD_ANY_KEY_EXISTS RSA_CL10_6_REDIR_KEEPPATH_WILD_ANY -logAction LOG_CL10_6_HTTP_RSP_REDIR_KEEPPATH_WILD_ANY
add responder policy RSP_CL10_6_NO_SERVICE_WILD_ANY PE_CL10_6_HTTP_CS_WILD_ANY_KEY_EXISTS RSA_CL10_6_NO_SERVICE -logAction LOG_CL10_6_HTTP_RSP_NO_SERVICE_WILD_ANY


### TCP & UDP ###
add policy expression PE_CL10_6_TCP_LAN_KEY_EXISTS  "(CLIENT.TCP.CS_VSERVER.NAME + \";lan;tcp/\" + CLIENT.TCP.DSTPORT).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CS_CONTROL\")"
add policy expression PE_CL10_6_TCP_LAN_VS  "(CLIENT.TCP.CS_VSERVER.NAME + \";lan;tcp/\" + CLIENT.TCP.DSTPORT).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add policy expression PE_CL10_6_TCP_ANY_KEY_EXISTS  "(CLIENT.TCP.CS_VSERVER.NAME + \";any;tcp/\" + CLIENT.TCP.DSTPORT).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CS_CONTROL\")"
add policy expression PE_CL10_6_TCP_ANY_VS  "(CLIENT.TCP.CS_VSERVER.NAME + \";any;tcp/\" + CLIENT.TCP.DSTPORT).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"

add audit messageaction LOG_CL10_6_TCP_LAN INFORMATIONAL "\"CL_10_6_CSP,TCP,LAN,\" + CLIENT.IP.SRC + \",\" + CLIENT.TCP.CS_VSERVER.NAME + \",\" + CLIENT.TCP.DSTPORT.TYPECAST_TEXT_T + \",\" + PE_CL10_6_TCP_LAN_VS"
add audit messageaction LOG_CL10_6_TCP_ANY INFORMATIONAL "\"CL_10_6_CSP,TCP,ANY,\" + CLIENT.IP.SRC + \",\" + CLIENT.TCP.CS_VSERVER.NAME + \",\" + CLIENT.TCP.DSTPORT.TYPECAST_TEXT_T + \",\" + PE_CL10_6_TCP_ANY_VS

add cs action CSA_CL10_6_TCP_LAN -targetVserverExpr PE_CL10_6_TCP_LAN_VS
add cs action CSA_CL10_6_TCP_ANY -targetVserverExpr PE_CL10_6_TCP_ANY_VS

add cs policy CSP_CL10_6_TCP_LAN -rule "(PE_CL10_6_TCP_LAN_KEY_EXISTS && (PE_CL10_6_TCP_CS_IP_ISLAN_3X || PE_CL10_6_TCP_CS_IP_ISLAN_2X_B || PE_CL10_6_TCP_CS_IP_ISLAN_2X_A || PE_CL10_6_TCP_CS_IP_ISLAN_1X))" -action CSA_CL10_6_TCP_LAN -logAction LOG_CL10_6_TCP_LAN
add cs policy CSP_CL10_6_TCP_ANY -rule PE_CL10_6_TCP_ANY_KEY_EXISTS -action CSA_CL10_6_TCP_ANY -logAction LOG_CL10_6_TCP_ANY


add policy expression PE_CL10_6_UDP_LAN_KEY_EXISTS  "(CLIENT.UDP.CS_VSERVER.NAME + \";lan;UDP/\" + CLIENT.UDP.DSTPORT).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CS_CONTROL\")"
add policy expression PE_CL10_6_UDP_LAN_VS  "(CLIENT.UDP.CS_VSERVER.NAME + \";lan;UDP/\" + CLIENT.UDP.DSTPORT).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"
add policy expression PE_CL10_6_UDP_ANY_KEY_EXISTS  "(CLIENT.UDP.CS_VSERVER.NAME + \";any;UDP/\" + CLIENT.UDP.DSTPORT).TO_LOWER.IS_STRINGMAP_KEY(\"SM_CS_CONTROL\")"
add policy expression PE_CL10_6_UDP_ANY_VS  "(CLIENT.UDP.CS_VSERVER.NAME + \";any;UDP/\" + CLIENT.UDP.DSTPORT).TO_LOWER.MAP_STRING(\"SM_CS_CONTROL\").AFTER_STR(\"vs=\").BEFORE_STR(\";\")"

add audit messageaction LOG_CL10_6_UDP_LAN INFORMATIONAL "\"CL_10_6_CSP,UDP,LAN,\" + CLIENT.IP.SRC + \",\" + CLIENT.UDP.CS_VSERVER.NAME + \",\" + CLIENT.UDP.DSTPORT.TYPECAST_TEXT_T + \",\" + PE_CL10_6_UDP_LAN_VS"
add audit messageaction LOG_CL10_6_UDP_ANY INFORMATIONAL "\"CL_10_6_CSP,UDP,ANY,\" + CLIENT.IP.SRC + \",\" + CLIENT.UDP.CS_VSERVER.NAME + \",\" + CLIENT.UDP.DSTPORT.TYPECAST_TEXT_T + \",\" + PE_CL10_6_UDP_ANY_VS

add cs action CSA_CL10_6_UDP_LAN -targetVserverExpr PE_CL10_6_UDP_LAN_VS
add cs action CSA_CL10_6_UDP_ANY -targetVserverExpr PE_CL10_6_UDP_ANY_VS

add cs policy CSP_CL10_6_UDP_LAN -rule "(PE_CL10_6_UDP_LAN_KEY_EXISTS && (PE_CL10_6_UDP_CS_IP_ISLAN_3X || PE_CL10_6_UDP_CS_IP_ISLAN_2X_B || PE_CL10_6_UDP_CS_IP_ISLAN_2X_A || PE_CL10_6_UDP_CS_IP_ISLAN_1X))" -action CSA_CL10_6_UDP_LAN -logAction LOG_CL10_6_UDP_LAN
add cs policy CSP_CL10_6_UDP_ANY -rule PE_CL10_6_UDP_ANY_KEY_EXISTS -action CSA_CL10_6_UDP_ANY -logAction LOG_CL10_6_UDP_ANY





### IP WHITELISTING/BLACKLISTING ###
### CONTENT SWITCHING VIRTUAL SERVERS ###
add policy expression PE_CL10_6_IP_CSTCP_IS_LISTED "(CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER).IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"
add policy expression PE_CL10_6_IP_CSTCP_IS_WHITELISTED "(CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER).MAP_STRING(\"SM_IP_CONTROL\").AFTER_STR(\"list=\").BEFORE_STR(\";\").EQ(\"whitelist\")"
add policy expression PE_CL10_6_IP_CSTCP_IS_BLACKLISTED "(CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER).MAP_STRING(\"SM_IP_CONTROL\").AFTER_STR(\"list=\").BEFORE_STR(\";\").EQ(\"blacklist\")"
add policy expression PE_CL10_6_IP_CSTCP_3X "(CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.TYPECAST_TEXT_T + \"/32\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(31).TYPECAST_TEXT_T + \"/31\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(30).TYPECAST_TEXT_T + \"/30\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"
add policy expression PE_CL10_6_IP_CSTCP_2X_B "(CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(29).TYPECAST_TEXT_T + \"/29\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(28).TYPECAST_TEXT_T + \"/28\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(27).TYPECAST_TEXT_T + \"/27\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(26).TYPECAST_TEXT_T + \"/26\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(25).TYPECAST_TEXT_T + \"/25\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"
add policy expression PE_CL10_6_IP_CSTCP_2X_A "(CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(24).TYPECAST_TEXT_T + \"/24\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(23).TYPECAST_TEXT_T + \"/23\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(22).TYPECAST_TEXT_T + \"/22\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(21).TYPECAST_TEXT_T + \"/21\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(20).TYPECAST_TEXT_T + \"/20\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"
add policy expression PE_CL10_6_IP_CSTCP_1X "(CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(19).TYPECAST_TEXT_T + \"/19\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(18).TYPECAST_TEXT_T + \"/18\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(17).TYPECAST_TEXT_T + \"/17\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(16).TYPECAST_TEXT_T + \"/16\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(15).TYPECAST_TEXT_T + \"/15\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(14).TYPECAST_TEXT_T + \"/14\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"

add audit messageaction LOG_CL10_6_RSP_CL10_6_BLOCKED_CS INFORMATIONAL "\"BLOCKED - \" + CLIENT.TCP.CS_VSERVER.NAME + \" - \" + CLIENT.IP.SRC" -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_RSP_CL10_6_BLOCKED_CS_WHITE INFORMATIONAL "\"BLOCKED WHITELIST - \" + CLIENT.TCP.CS_VSERVER.NAME + \" - \" + CLIENT.IP.SRC" -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_RSP_CL10_6_BLOCKED_CS_BLACK INFORMATIONAL "\"BLOCKED BLACKLIST - \" + CLIENT.TCP.CS_VSERVER.NAME + \" - \" + CLIENT.IP.SRC" -bypassSafetyCheck YES

add responder policy RSP_CL10_6_CSTCP_BLOCKED_NOT_LISTED "!PE_CL10_6_IP_CSTCP_IS_LISTED" RESET -comment "SM_IP_CONTROL Blocked" -logAction LOG_CL10_6_RSP_CL10_6_BLOCKED_CS
add responder policy RSP_CL10_6_CSTCP_BLOCKED_WHITE "PE_CL10_6_IP_CSTCP_IS_LISTED && PE_CL10_6_IP_CSTCP_IS_WHITELISTED && !(PE_CL10_6_IP_CSTCP_3X || PE_CL10_6_IP_CSTCP_2X_B || PE_CL10_6_IP_CSTCP_2X_A || PE_CL10_6_IP_CSTCP_1X)" RESET -comment "SM_IP_CONTROL Blocked" -logAction LOG_CL10_6_RSP_CL10_6_BLOCKED_CS_WHITE
add responder policy RSP_CL10_6_CSTCP_BLOCKED_BLACK "PE_CL10_6_IP_CSTCP_IS_LISTED && PE_CL10_6_IP_CSTCP_IS_BLACKLISTED && (PE_CL10_6_IP_CSTCP_3X || PE_CL10_6_IP_CSTCP_2X_B || PE_CL10_6_IP_CSTCP_2X_A || PE_CL10_6_IP_CSTCP_1X)" RESET -comment "SM_IP_CONTROL Blocked" -logAction LOG_CL10_6_RSP_CL10_6_BLOCKED_CS_BLACK

### LOAD BALANCING VIRTUAL SERVERS ###
add policy expression PE_CL10_6_IP_VSTCP_IS_LISTED "(CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER).IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"
add policy expression PE_CL10_6_IP_VSTCP_IS_WHITELISTED "(CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER).MAP_STRING(\"SM_IP_CONTROL\").AFTER_STR(\"list=\").BEFORE_STR(\";\").EQ(\"whitelist\")"
add policy expression PE_CL10_6_IP_VSTCP_IS_BLACKLISTED "(CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER).MAP_STRING(\"SM_IP_CONTROL\").AFTER_STR(\"list=\").BEFORE_STR(\";\").EQ(\"blacklist\")"
add policy expression PE_CL10_6_IP_VSTCP_3X "(CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.TYPECAST_TEXT_T + \"/32\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(31).TYPECAST_TEXT_T + \"/31\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(30).TYPECAST_TEXT_T + \"/30\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"
add policy expression PE_CL10_6_IP_VSTCP_2X_B "(CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(29).TYPECAST_TEXT_T + \"/29\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(28).TYPECAST_TEXT_T + \"/28\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(27).TYPECAST_TEXT_T + \"/27\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(26).TYPECAST_TEXT_T + \"/26\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(25).TYPECAST_TEXT_T + \"/25\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"
add policy expression PE_CL10_6_IP_VSTCP_2X_A "(CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(24).TYPECAST_TEXT_T + \"/24\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(23).TYPECAST_TEXT_T + \"/23\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(22).TYPECAST_TEXT_T + \"/22\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(21).TYPECAST_TEXT_T + \"/21\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(20).TYPECAST_TEXT_T + \"/20\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"
add policy expression PE_CL10_6_IP_VSTCP_1X "(CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(19).TYPECAST_TEXT_T + \"/19\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(18).TYPECAST_TEXT_T + \"/18\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(17).TYPECAST_TEXT_T + \"/17\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(16).TYPECAST_TEXT_T + \"/16\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(15).TYPECAST_TEXT_T + \"/15\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\") || (CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER + \";any;\" + CLIENT.IP.SRC.SUBNET(14).TYPECAST_TEXT_T + \"/14\").IS_STRINGMAP_KEY(\"SM_IP_CONTROL\")"

add audit messageaction LOG_CL10_6_RSP_CL10_6_BLOCKED_VS INFORMATIONAL "\"BLOCKED - \" + CLIENT.TCP.LB_VSERVER.NAME + \" - \" + CLIENT.IP.SRC" -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_RSP_CL10_6_BLOCKED_VS_WHITE INFORMATIONAL "\"BLOCKED WHITELIST - \" + CLIENT.TCP.LB_VSERVER.NAME + \" - \" + CLIENT.IP.SRC" -bypassSafetyCheck YES
add audit messageaction LOG_CL10_6_RSP_CL10_6_BLOCKED_VS_BLACK INFORMATIONAL "\"BLOCKED BLACKLIST - \" + CLIENT.TCP.LB_VSERVER.NAME + \" - \" + CLIENT.IP.SRC" -bypassSafetyCheck YES

add responder policy RSP_CL10_6_VSTCP_BLOCKED_NOT_LISTED "!PE_CL10_6_IP_VSTCP_IS_LISTED" RESET -comment "SM_IP_CONTROL Blocked" -logAction LOG_CL10_6_RSP_CL10_6_BLOCKED_VS
add responder policy RSP_CL10_6_VSTCP_BLOCKED_WHITE "PE_CL10_6_IP_VSTCP_IS_LISTED && PE_CL10_6_IP_VSTCP_IS_WHITELISTED && !(PE_CL10_6_IP_VSTCP_3X || PE_CL10_6_IP_VSTCP_2X_B || PE_CL10_6_IP_VSTCP_2X_A || PE_CL10_6_IP_VSTCP_1X) " RESET -comment "SM_IP_CONTROL Blocked" -logAction LOG_CL10_6_RSP_CL10_6_BLOCKED_VS_WHITE
add responder policy RSP_CL10_6_VSTCP_BLOCKED_BLACK "PE_CL10_6_IP_VSTCP_IS_LISTED && PE_CL10_6_IP_VSTCP_IS_BLACKLISTED &&(PE_CL10_6_IP_VSTCP_3X || PE_CL10_6_IP_VSTCP_2X_B || PE_CL10_6_IP_VSTCP_2X_A || PE_CL10_6_IP_VSTCP_1X) " RESET -comment "SM_IP_CONTROL Blocked" -logAction LOG_CL10_6_RSP_CL10_6_BLOCKED_VS_BLACK
add responder policy RSP_CL10_6_VSHTTP_BLOCKED_NOT_LISTED PE_CL10_6_IP_VSTCP_IS_LISTED RESET -comment "SM_IP_CONTROL Blocked"


### LOGGING MESSAGES ###
add audit messageaction LOG_CL10_6_UNAUTHORIZED INFORMATIONAL "\"UNAUTHORIZED - \" + HTTP.REQ.CS_VSERVER.NAME + \" - \" + HTTP.REQ.LB_VSERVER.NAME + \" - \" + HTTP.REQ.USER.NAME" -bypassSafetyCheck YES


add audit messageaction LOG_CL10_6_CORE_TX_COMPLETE INFORMATIONAL q/"CL_10_6_RWP,HTTP,OK," + PE_CL10_6_RES_TXID + "," + HTTP.REQ.LB_VSERVER.NAME + "," + SERVER.IP.SRC/ -bypassSafetyCheck YES
add rewrite policy RWP_CL10_6_CORE_TX_COMPLETE true NOREWRITE -logAction LOG_CL10_6_CORE_TX_COMPLETE

### REQUEST REWRITE ###
add rewrite action RWA_CL10_6_CORE_INS_X_FORWARDED_BY insert_http_header X-Forwarded-By HTTP.REQ.CS_VSERVER.NAME -comment "Inserts X-Forwarded-by; the name of the contentswitch that received the request"
add rewrite action RWA_CL10_6_CORE_INS_X_FORWARDED_FOR insert_http_header X-Forwarded-For CLIENT.IP.SRC -comment "Inserts X-Forwarded-For; the original client source ip"
add rewrite action RWA_CL10_6_CORE_INS_X_FORWARDED_PROTO_HTTP insert_http_header X-Forwarded-Proto "\"HTTP\"" -comment "Inserts X-Forwarded-Proto; HTTP = the original request was NOT offloaded"
add rewrite action RWA_CL10_6_CORE_INS_X_FORWARDED_PROTO_HTTPS insert_http_header X-Forwarded-Proto "\"HTTPS\"" -comment "Inserts X-Forwarded-Proto; HTTPS = the original request was offloaded"
add rewrite action RWA_CL10_6_CORE_DEL_ACCEPT_ENCODING delete_http_header Accept-Encoding -comment "Deletes Accept-Encoding; disables compression in the backend response"

add rewrite policy RWP_CL10_6_CORE_INS_X_FORWARDED_BY true RWA_CL10_6_CORE_INS_X_FORWARDED_BY
add rewrite policy RWP_CL10_6_CORE_INS_X_FORWARDED_FOR true RWA_CL10_6_CORE_INS_X_FORWARDED_FOR
add rewrite policy RWP_CL10_6_CORE_INS_X_FORWARDED_PROTO_HTTP "!PE_CL10_6_IS_SSL" RWA_CL10_6_CORE_INS_X_FORWARDED_PROTO_HTTP
add rewrite policy RWP_CL10_6_CORE_INS_X_FORWARDED_PROTO_HTTPS PE_CL10_6_IS_SSL RWA_CL10_6_CORE_INS_X_FORWARDED_PROTO_HTTPS
add rewrite policy RWP_CL10_6_CORE_DEL_ACCEPT_ENCODING true RWA_CL10_6_CORE_DEL_ACCEPT_ENCODING

add rewrite policylabel RWPL_CL10_6_CS_REQ_CORE http_req
bind rewrite policylabel RWPL_CL10_6_CS_REQ_CORE RWP_CL10_6_CORE_DEL_ACCEPT_ENCODING 1 NEXT
bind rewrite policylabel RWPL_CL10_6_CS_REQ_CORE RWP_CL10_6_CORE_INS_X_FORWARDED_FOR 2 NEXT
bind rewrite policylabel RWPL_CL10_6_CS_REQ_CORE RWP_CL10_6_CORE_INS_X_FORWARDED_BY 3 NEXT
bind rewrite policylabel RWPL_CL10_6_CS_REQ_CORE RWP_CL10_6_CORE_INS_X_FORWARDED_PROTO_HTTPS 4 NEXT
bind rewrite policylabel RWPL_CL10_6_CS_REQ_CORE RWP_CL10_6_CORE_INS_X_FORWARDED_PROTO_HTTP 5 NEXT

### RESPONSE REWRITE
add rewrite action RWA_CL10_6_CORE_DEL_X_ASPNET_VERSION delete_http_header X-AspNet-Version
add rewrite action RWA_CL10_6_CORE_DEL_SERVER delete_http_header Server
add rewrite action RWA_CL10_6_CORE_DEL_X_POWERED_BY delete_http_header X-Powered-By
add rewrite action RWA_CL10_6_CORE_INS_TXID insert_http_header TXID "HTTP.RES.TXID.BEFORE_STR(\"-\")"

add rewrite policy RWP_CL10_6_CORE_DEL_X_ASPNET_VERSION true RWA_CL10_6_CORE_DEL_X_ASPNET_VERSION
add rewrite policy RWP_CL10_6_CORE_DEL_SERVER true RWA_CL10_6_CORE_DEL_SERVER
add rewrite policy RWP_CL10_6_CORE_DEL_X_POWERED_BY true RWA_CL10_6_CORE_DEL_X_POWERED_BY
add rewrite policy RWP_CL10_6_CORE_INS_TXID PE_CL10_6_DEBUG RWA_CL10_6_CORE_INS_TXID

add rewrite policylabel RWPL_CL10_6_CS_RES_CORE http_res
bind rewrite policylabel RWPL_CL10_6_CS_RES_CORE RWP_CL10_6_CORE_DEL_X_ASPNET_VERSION 20 NEXT
bind rewrite policylabel RWPL_CL10_6_CS_RES_CORE RWP_CL10_6_CORE_DEL_SERVER 21 NEXT
bind rewrite policylabel RWPL_CL10_6_CS_RES_CORE RWP_CL10_6_CORE_DEL_X_POWERED_BY 22 NEXT
bind rewrite policylabel RWPL_CL10_6_CS_RES_CORE RWP_CL10_6_CORE_TX_COMPLETE 23 NEXT
bind rewrite policylabel RWPL_CL10_6_CS_RES_CORE RWP_CL10_6_CORE_INS_TXID 24 NEXT



add rewrite action RWA_CL10_6_SSLOnly_INS_STRICT_TRANSPORT_SECURITY insert_http_header Strict-Transport-Security "\"max-age=157680000\""
add rewrite policy RWP_CL10_6_SSLOnly_INS_STRICT_TRANSPORT_SECURITY "PE_CL10_6_IS_SSL && !HTTP.RES.HEADER(\"Strict-Transport-Security\").EXISTS" RWA_CL10_6_SSLOnly_INS_STRICT_TRANSPORT_SECURITY

add rewrite policylabel RWPL_CL10_6_CS_RES_SSLONLY http_res
bind rewrite policylabel RWPL_CL10_6_CS_RES_SSLONLY RWP_CL10_6_SSLOnly_INS_STRICT_TRANSPORT_SECURITY 30 NEXT


#add rewrite action RWA_CL10_6_SEC_ANTI_CLICKJACKING insert_http_header X-Frame-Option "\"SAMEORIGIN\""
#add rewrite action RWA_CL10_6_SEC_ANTI_SLOW_POST replace_all "HTTP.REQ.BODY(999999)" HTTP.REQ.METHOD -search "text(\"a_ string_that_does_not _occur\")"
#
#add rewrite policy RWP_CL10_6_SEC_ANTI_CLICKJACKING "HTTP.RES.HEADER(\"X-Frame-Option\").CONTAINS(\"SAMEORIGIN\").NOT" RWA_CL10_6_SEC_ANTI_CLICKJACKING
#add rewrite policy RWP_CL10_6_SEC_ANTI_SLOW_POST "HTTP.REQ.METHOD.EQ(POST)" RWA_CL10_6_SEC_ANTI_SLOW_POST
#
#
#add rewrite policylabel RWPL_CL10_6_CS_REQ_SEC http_req
#add rewrite policylabel RWPL_CL10_6_CS_RES_SEC http_res
#bind rewrite policylabel RWPL_CL10_6_CS_REQ_SEC RWP_CL10_6_SEC_ANTI_SLOW_POST 70 NEXT
#bind rewrite policylabel RWPL_CL10_6_CS_RES_SEC RWP_CL10_6_SEC_ANTI_CLICKJACKING 50 NEXT





### GENERAL PURPOSE SERVERS ### 
### DEFAULT SERVERS ###
add server DUMMY 1.2.3.4

### SERVICE GROUPS ###
 add serviceGroup SG_DUMMY_HTTP HTTP -maxClient 0 -maxReq 0 -cip DISABLED -usip NO -useproxyport YES -healthMonitor NO -cltTimeout 180 -svrTimeout 360 -CKA NO -TCPB NO -CMP YES
bind serviceGroup SG_DUMMY_HTTP DUMMY 80

### LOAD BALANCING VIRTUAL SERVERS ###
### VS_REDIR_301 - 301 Redirects ###
 add lb vserver VS_REDIR_301 HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_REDIR_301 SG_DUMMY_HTTP
bind lb vserver VS_REDIR_301 -policyName RSP_CL10_6_REDIR_FULL_LAN -priority 100 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_301 -policyName RSP_CL10_6_REDIR_SCND_LAN -priority 101 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_301 -policyName RSP_CL10_6_REDIR_FRST_LAN -priority 102 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_301 -policyName RSP_CL10_6_REDIR_FQDN_LAN -priority 103 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_301 -policyName RSP_CL10_6_REDIR_WILD_LAN -priority 104 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_301 -policyName RSP_CL10_6_REDIR_FULL_ANY -priority 110 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_301 -policyName RSP_CL10_6_REDIR_SCND_ANY -priority 111 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_301 -policyName RSP_CL10_6_REDIR_FRST_ANY -priority 112 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_301 -policyName RSP_CL10_6_REDIR_FQDN_ANY -priority 113 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_301 -policyName RSP_CL10_6_REDIR_WILD_ANY -priority 114 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_IP_CONTROL vs_redir_301 "list=blacklist;"

### VS_REDIR_302 - 302 Redirects ###
 add lb vserver VS_REDIR_302 HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_REDIR_302 SG_DUMMY_HTTP
bind lb vserver VS_REDIR_302 -policyName RSP_CL10_6_REDIR_FULL_LAN -priority 100 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302 -policyName RSP_CL10_6_REDIR_SCND_LAN -priority 101 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302 -policyName RSP_CL10_6_REDIR_FRST_LAN -priority 102 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302 -policyName RSP_CL10_6_REDIR_FQDN_LAN -priority 103 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302 -policyName RSP_CL10_6_REDIR_WILD_LAN -priority 104 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302 -policyName RSP_CL10_6_REDIR_FULL_ANY -priority 110 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302 -policyName RSP_CL10_6_REDIR_SCND_ANY -priority 111 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302 -policyName RSP_CL10_6_REDIR_FRST_ANY -priority 112 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302 -policyName RSP_CL10_6_REDIR_FQDN_ANY -priority 113 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302 -policyName RSP_CL10_6_REDIR_WILD_ANY -priority 114 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_IP_CONTROL vs_redir_302 "list=blacklist;"

### VS_REDIR_302_KEEPPATH - 302 Redirects ###
 add lb vserver VS_REDIR_302_KEEPPATH HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_REDIR_302_KEEPPATH SG_DUMMY_HTTP
bind lb vserver VS_REDIR_302_KEEPPATH -policyName RSP_CL10_6_REDIR_KEEPPATH_FULL_LAN -priority 100 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302_KEEPPATH -policyName RSP_CL10_6_REDIR_KEEPPATH_SCND_LAN -priority 101 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302_KEEPPATH -policyName RSP_CL10_6_REDIR_KEEPPATH_FRST_LAN -priority 102 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302_KEEPPATH -policyName RSP_CL10_6_REDIR_KEEPPATH_FQDN_LAN -priority 103 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302_KEEPPATH -policyName RSP_CL10_6_REDIR_KEEPPATH_WILD_LAN -priority 104 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302_KEEPPATH -policyName RSP_CL10_6_REDIR_KEEPPATH_FULL_ANY -priority 110 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302_KEEPPATH -policyName RSP_CL10_6_REDIR_KEEPPATH_SCND_ANY -priority 111 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302_KEEPPATH -policyName RSP_CL10_6_REDIR_KEEPPATH_FRST_ANY -priority 112 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302_KEEPPATH -policyName RSP_CL10_6_REDIR_KEEPPATH_FQDN_ANY -priority 113 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_REDIR_302_KEEPPATH -policyName RSP_CL10_6_REDIR_KEEPPATH_WILD_ANY -priority 114 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_IP_CONTROL vs_redir_302_keeppath "list=blacklist;"

### VS_REDIR_302_SWITCH - 302 Redirects to switch protocol between HTTP/HTTPS ###
 add lb vserver VS_REDIR_302_SWITCH HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_REDIR_302_SWITCH SG_DUMMY_HTTP
bind lb vserver VS_REDIR_302_SWITCH -policyName RSP_CL10_6_REDIR_302_SWITCH -priority 101 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_IP_CONTROL vs_redir_302_switch "list=blacklist;"

### VS_NO_SERVICE_HTTP - Default load balancer for HTTP ###
 add lb vserver VS_NO_SERVICE_HTTP HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_NO_SERVICE_HTTP SG_DUMMY_HTTP
bind lb vserver VS_NO_SERVICE_HTTP -policyName RSP_CL10_6_NO_SERVICE_FULL_LAN -priority 100 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_HTTP -policyName RSP_CL10_6_NO_SERVICE_SCND_LAN -priority 101 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_HTTP -policyName RSP_CL10_6_NO_SERVICE_FRST_LAN -priority 102 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_HTTP -policyName RSP_CL10_6_NO_SERVICE_FQDN_LAN -priority 103 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_HTTP -policyName RSP_CL10_6_NO_SERVICE_WILD_LAN -priority 104 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_HTTP -policyName RSP_CL10_6_NO_SERVICE_FULL_ANY -priority 110 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_HTTP -policyName RSP_CL10_6_NO_SERVICE_FRST_ANY -priority 111 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_HTTP -policyName RSP_CL10_6_NO_SERVICE_SCND_ANY -priority 112 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_HTTP -policyName RSP_CL10_6_NO_SERVICE_FQDN_ANY -priority 113 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_HTTP -policyName RSP_CL10_6_NO_SERVICE_WILD_ANY -priority 114 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_HTTP -policyName RSP_CL10_6_REDIR_302_SWITCH -priority 250 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_IP_CONTROL vs_no_service_http "list=blacklist;"


### VS_NO_SERVICE_SSL - Default load balancer for SSL ###
 add lb vserver VS_NO_SERVICE_SSL HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_NO_SERVICE_SSL SG_DUMMY_HTTP
bind lb vserver VS_NO_SERVICE_SSL -policyName RSP_CL10_6_NO_SERVICE_FULL_LAN -priority 100 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_SSL -policyName RSP_CL10_6_NO_SERVICE_SCND_LAN -priority 101 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_SSL -policyName RSP_CL10_6_NO_SERVICE_FRST_LAN -priority 102 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_SSL -policyName RSP_CL10_6_NO_SERVICE_FQDN_LAN -priority 103 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_SSL -policyName RSP_CL10_6_NO_SERVICE_WILD_LAN -priority 104 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_SSL -policyName RSP_CL10_6_NO_SERVICE_FULL_ANY -priority 110 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_SSL -policyName RSP_CL10_6_NO_SERVICE_FRST_ANY -priority 111 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_SSL -policyName RSP_CL10_6_NO_SERVICE_FRST_ANY -priority 112 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_SSL -policyName RSP_CL10_6_NO_SERVICE_FQDN_ANY -priority 113 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_SSL -policyName RSP_CL10_6_NO_SERVICE_WILD_ANY -priority 114 -gotoPriorityExpression END -type REQUEST
bind lb vserver VS_NO_SERVICE_SSL -policyName RSP_CL10_6_BLOCKED -priority 250 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_IP_CONTROL vs_no_service_ssl "list=blacklist;"

### VS_BLOCKED - Default response for blocked traffic ###
 add lb vserver VS_BLOCKED HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_BLOCKED SG_DUMMY_HTTP
bind lb vserver VS_BLOCKED -policyName RSP_CL10_6_BLOCKED -priority 100 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_IP_CONTROL vs_blocked "list=blacklist;"

### VS_DROP - Default drop for unwanted traffic ###
 add lb vserver VS_DROP HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_DROP SG_DUMMY_HTTP
bind lb vserver VS_DROP -policyName RSP_CL10_6_DROP -priority 100 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_IP_CONTROL vs_drop "list=blacklist;"

### VS_RESET - Default reset for unwanted traffic ###
 add lb vserver VS_RESET HTTP 0.0.0.0 0 -persistenceType NONE -cltTimeout 180
bind lb vserver VS_RESET SG_DUMMY_HTTP
bind lb vserver VS_RESET -policyName RSP_CL10_6_RESET -priority 100 -gotoPriorityExpression END -type REQUEST

bind policy stringmap SM_IP_CONTROL vs_reset "list=blacklist;"













